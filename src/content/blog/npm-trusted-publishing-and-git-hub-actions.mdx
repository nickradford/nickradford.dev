---
title: npm Trusted Publishing and GitHub Actions
draft: false
date: 2025-12-11
tags: []
---
I'm building a little yeoman-esque tool as a learning and practice opportunity, since I've got some interviews coming up, and I wanted to get the package published via GitHub Actions. I found the `release-it` tool, which seemed to be a really nice way to set up the whole publishing process, including changelog generation, publishing to both npm and GitHub packages.

Well, with the recent npm suppy chain attacks, long-lived npm access tokens have been replaced with one of 2 options.

1. Granular access tokens, which are limited to 90 days, meaning every 3 months I'd have to regenerate and update these granular tokens.
2. Trusted publishing w/ OpenID Connect, which integrates with GitHub Actions (and GitLab CI/CD, with support for self-hosted runners coming in the future)

I opted for trusted publishing, as I can't trust myself to remember to rotate keys down the line and would likely get frustrated with the whole process eventually.

## Configuring Trusted Publishing

Setting up trusted publishing on the npm side is really simple. Just go to your package settings on npmjs.com and select your CI/CD provider. From here on in I'll only be mentioning GitHub Actions, but the setup should be mostly the same for GitLab.

![](/npm-trusted-publishing-and-git-hub-actions/image.png)

Fill in the organization/user and repository name, and the name of the workflow file (only the name of the file including its extension) that is calling the `npm publish` command. I assume at runtime, there is some verification around that workflow filename, perhaps it's set as an environment variable in the GitHub Action runner and passed along in the publish request to be validated.

![](/npm-trusted-publishing-and-git-hub-actions/image.png)

> Note: npm doesn't verify any of this information when you save this form. You'll only get opaque errors, usually 404s saying the package isn't found in the npm repository.

## Configuring GitHub Actions

Conversely, this is where I got into the weeds a bit. To be fair I was skimming a little bit and missed one critical comment in the documentation from npm, about using npm v11.5.1 or later, and ran into the aforementioned 404s.

Here are the **critical** items you need in your workflow.



```yml
permissions:

```
